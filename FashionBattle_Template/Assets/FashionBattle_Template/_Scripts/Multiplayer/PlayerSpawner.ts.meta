fileFormatVersion: 2
guid: 8d0e44a368c64f7498600c38868607c2
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst ZEPETO_Script_1 = require(\"ZEPETO.Script\");\r\nconst
    ZEPETO_Character_Controller_1 = require(\"ZEPETO.Character.Controller\");\r\nconst
    UnityEngine_1 = require(\"UnityEngine\");\r\nconst MultiplayerManager_1 = require(\"./MultiplayerManager\");\r\nconst
    ZEPETO_Mannequin_1 = require(\"ZEPETO.Mannequin\");\r\nconst Zepeto_1 = require(\"Zepeto\");\r\n//
    This script spawns a single player\r\nclass PlayerSpawner extends ZEPETO_Script_1.ZepetoScriptBehaviour
    {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._currentPlayers
    = new Map();\r\n    }\r\n    static get instance() {\r\n        if (this.m_instance
    === null) {\r\n            this.m_instance = UnityEngine_1.GameObject.FindObjectOfType($typeof(PlayerSpawner));\r\n           
    if (this.m_instance === null) {\r\n                this.m_instance = new UnityEngine_1.GameObject(PlayerSpawner.name).AddComponent($typeof(PlayerSpawner));\r\n           
    }\r\n        }\r\n        return this.m_instance;\r\n    }\r\n    Awake() {\r\n       
    if (PlayerSpawner.m_instance !== null && PlayerSpawner.m_instance !== this) {\r\n           
    UnityEngine_1.GameObject.Destroy(this.gameObject);\r\n        }\r\n        else
    {\r\n            PlayerSpawner.m_instance = this;\r\n            UnityEngine_1.GameObject.DontDestroyOnLoad(this.gameObject);\r\n       
    }\r\n    }\r\n    Start() {\r\n        ZEPETO_Character_Controller_1.ZepetoPlayers.instance.OnAddedPlayer.AddListener((sessionId)
    => {\r\n            this.AddPlayerSync(sessionId);\r\n            ZEPETO_Character_Controller_1.ZepetoPlayers.instance.ZepetoCamera.gameObject.SetActive(false);\r\n       
    });\r\n    }\r\n    /** multiplayer Spawn **/\r\n    OnStateChange(state, isFirst)
    {\r\n        const join = new Map();\r\n        const leave = new Map(this._currentPlayers);\r\n       
    state.players.ForEach((sessionId, player) => {\r\n            if (!this._currentPlayers.has(sessionId))
    {\r\n                join.set(sessionId, player);\r\n            }\r\n           
    leave.delete(sessionId);\r\n        });\r\n        // [RoomState] Create a player
    instance for players that enter the Room\r\n        join.forEach((player, sessionId)
    => this.OnJoinPlayer(sessionId, player));\r\n        // [RoomState] Remove the
    player instance for players that exit the room\r\n        leave.forEach((player,
    sessionId) => this.OnLeavePlayer(sessionId, player));\r\n    }\r\n    OnJoinPlayer(sessionId,
    player) {\r\n        console.log(`[OnJoinPlayer] players - sessionId : ${sessionId}`);\r\n       
    this._currentPlayers.set(sessionId, player);\r\n        const spawnInfo = new
    ZEPETO_Character_Controller_1.SpawnInfo();\r\n        spawnInfo.position = this.transform.position;\r\n       
    spawnInfo.rotation = this.transform.rotation;\r\n        const isLocal = MultiplayerManager_1.default.instance.GetRoom().SessionId
    === player.sessionId;\r\n        $extension(\"ZEPETO.Character.Controller.ZepetoPlayersExtension\").CreatePlayerWithUserId(ZEPETO_Character_Controller_1.ZepetoPlayers.instance,
    sessionId, player.zepetoUserId, spawnInfo, isLocal);\r\n    }\r\n    OnLeavePlayer(sessionId,
    player) {\r\n        console.log(`[OnLeavePlayer] players - sessionId : ${sessionId}`);\r\n       
    this._currentPlayers.delete(sessionId);\r\n        ZEPETO_Character_Controller_1.ZepetoPlayers.instance.RemovePlayer(sessionId);\r\n   
    }\r\n    AddPlayerSync(sessionId) {\r\n        UnityEngine_1.Debug.LogError(\"ADD
    PLAYER\");\r\n        const zepetoPlayer = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId);\r\n       
    zepetoPlayer.character.gameObject.SetActive(false);\r\n    }\r\n    UpdateCharacterCloth(sessionId)
    {\r\n        let playerData = MultiplayerManager_1.default.instance.GetPlayerData(sessionId);\r\n       
    this.itemContent = new ZEPETO_Mannequin_1.ItemContent();\r\n        if (playerData.headItem
    != \"\") {\r\n            this.itemContent.id = playerData.headItem;\r\n           
    this.itemContent.property = Zepeto_1.ZepetoPropertyFlag.AccessoryHeadwear;\r\n       
    }\r\n        if (playerData.chestItem != \"\") {\r\n            this.itemContent.id
    = playerData.chestItem;\r\n            this.itemContent.property = Zepeto_1.ZepetoPropertyFlag.ClothesTop;\r\n       
    }\r\n        if (playerData.legsItem != \"\") {\r\n            this.itemContent.id
    = playerData.legsItem;\r\n            this.itemContent.property = Zepeto_1.ZepetoPropertyFlag.ClothesBottom;\r\n       
    }\r\n        if (playerData.footItem != \"\") {\r\n            this.itemContent.id
    = playerData.footItem;\r\n            this.itemContent.property = Zepeto_1.ZepetoPropertyFlag.ClothesShoes;\r\n       
    }\r\n        const zepetoPlayer = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId);\r\n       
    let context = zepetoPlayer.character.Context;\r\n        this._previewer = new
    ZEPETO_Mannequin_1.MannequinPreviewer(context, [this.itemContent]);\r\n       
    this._previewer.PreviewContents();\r\n    }\r\n    ShowCharacter(sessionId) {\r\n       
    const zepetoPlayer = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId);\r\n       
    zepetoPlayer.character.gameObject.transform.position = this.spawnPosition.position;\r\n       
    zepetoPlayer.character.gameObject.transform.rotation = this.spawnPosition.rotation;\r\n       
    zepetoPlayer.character.gameObject.SetActive(true);\r\n        this.UpdateCharacterCloth(sessionId);\r\n   
    }\r\n    HideCharacter(sessionId) {\r\n        const zepetoPlayer = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId);\r\n       
    zepetoPlayer.character.gameObject.transform.position = this.spawnPosition.position;\r\n       
    zepetoPlayer.character.gameObject.transform.rotation = this.spawnPosition.rotation;\r\n       
    zepetoPlayer.character.gameObject.SetActive(false);\r\n    }\r\n}\r\nexports.default
    = PlayerSpawner;\r\n/* Singleton */\r\nPlayerSpawner.m_instance = null;\r\n//#
    sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUGxheWVyU3Bhd25lci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlBsYXllclNwYXduZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpREFBc0Q7QUFDdEQsNkVBQW9GO0FBRXBGLDZDQUEyRDtBQUMzRCw2REFBMkU7QUFDM0UsdURBQW1FO0FBQ25FLG1DQUEyRDtBQUUzRCxxQ0FBcUM7QUFDckMsTUFBcUIsYUFBYyxTQUFRLHFDQUFxQjtJQUFoRTs7UUFHWSxvQkFBZSxHQUF3QixJQUFJLEdBQUcsRUFBa0IsQ0FBQztJQXdJN0UsQ0FBQztJQWhJVSxNQUFNLEtBQUssUUFBUTtRQUN0QixJQUFJLElBQUksQ0FBQyxVQUFVLEtBQUssSUFBSSxFQUFFO1lBQzFCLElBQUksQ0FBQyxVQUFVLEdBQUcsd0JBQVUsQ0FBQyxnQkFBZ0IsU0FBQyxhQUFhLEVBQUcsQ0FBQztZQUMvRCxJQUFJLElBQUksQ0FBQyxVQUFVLEtBQUssSUFBSSxFQUFFO2dCQUMxQixJQUFJLENBQUMsVUFBVSxHQUFHLElBQUksd0JBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsWUFBWSxTQUFDLGFBQWEsRUFBRyxDQUFDO2FBQ3RGO1NBQ0o7UUFDRCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDM0IsQ0FBQztJQUVPLEtBQUs7UUFDVCxJQUFJLGFBQWEsQ0FBQyxVQUFVLEtBQUssSUFBSSxJQUFJLGFBQWEsQ0FBQyxVQUFVLEtBQUssSUFBSSxFQUFFO1lBQ3hFLHdCQUFVLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztTQUN2QzthQUFNO1lBQ0gsYUFBYSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7WUFDaEMsd0JBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDakQ7SUFDTCxDQUFDO0lBRU8sS0FBSztRQUVULDJDQUFhLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENB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","assetPath":"Assets/FashionBattle_Template/_Scripts/Multiplayer/PlayerSpawner.ts","manifest":{"properties":[{"assembly":"UnityEngine.CoreModule","name":"spawnPosition","type":"UnityEngine.Transform","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]}],"name":"PlayerSpawner","description":"","hasAnimatorMove":false},"isCompiled":true}'
  typescriptHash: cb89ad982f2aee633219a06709525df1
  onlyWriteTrigger: 0
